# Fridge Photo to Recipe – Developer Specification

## Project Overview

**El Hornito** is a web application that allows users to upload photos of their fridge contents and receive personalized recipe suggestions generated by Claude AI from Anthropic. The application analyzes the visible ingredients in the photo and provides practical recipes that can be made with the available ingredients.

## Core Use Case

1. User uploads a photo of their fridge contents
2. Image is sent to Claude AI (Anthropic) for ingredient analysis
3. Claude generates a recipe suggestion based on identified ingredients
4. User receives a complete recipe with ingredients list and cooking instructions

---

## Technical Architecture

### Frontend (Next.js 15 + React 19 + TypeScript)

#### Components Structure

**`FridgeUploader.tsx`**

- **Purpose**: Handle image upload functionality
- **Features**:
  - Drag & drop file upload interface
  - File picker fallback
  - Image preview before submission
  - File type validation (JPEG, PNG, WebP)
  - File size validation (max 10MB)
  - Upload progress indicator
  - Error state handling
- **Props**: `onUploadSuccess: (recipe: Recipe) => void`, `onError: (error: string) => void`

**`RecipeDisplay.tsx`**

- **Purpose**: Display the generated recipe
- **Features**:
  - Recipe title with styling
  - Formatted ingredients list with checkboxes
  - Step-by-step cooking instructions
  - Cooking time and difficulty indicators (if provided)
  - Save/share recipe functionality
  - Print-friendly layout
- **Props**: `recipe: Recipe | null`, `isLoading: boolean`

**`RecipeCard.tsx`**

- **Purpose**: Compact recipe preview component
- **Features**:
  - Recipe thumbnail (generated or default)
  - Quick recipe overview
  - Click to expand full recipe
- **Props**: `recipe: Recipe`, `onClick: () => void`

**UI Components**

- `Button.tsx` - Styled button component with variants
- `LoadingSpinner.tsx` - Loading indicator for async operations

#### State Management

- Use React hooks for local state management
- Implement proper loading states for all async operations
- Error boundary for graceful error handling

### Backend (Next.js API Routes)

#### API Endpoints

**`POST /api/analyze-fridge`**

- **Purpose**: Process fridge photo and return recipe
- **Request**:
  ```typescript
  Content-Type: multipart/form-data
  Body: {
    image: File // Image file of fridge contents
    preferences?: string // Optional dietary preferences
  }
  ```
- **Response**:
  ```typescript
  {
    success: boolean;
    recipe?: Recipe;
    error?: string;
  }
  ```
- **Processing Flow**:
  1. Validate image file (type, size, format)
  2. Convert image to base64 for Claude API
  3. Send prompt with image to Claude
  4. Parse Claude response into structured recipe
  5. Return formatted response

#### Claude AI Integration

**Prompt Engineering**

```
Analyze this fridge photo and identify all visible ingredients. Based on the available ingredients, suggest ONE complete recipe that can be made primarily with these ingredients.

Please respond in this exact JSON format:
{
  "title": "Recipe Name",
  "description": "Brief description of the dish",
  "cookingTime": "30 minutes",
  "difficulty": "Easy|Medium|Hard",
  "servings": 4,
  "ingredients": [
    "2 cups flour",
    "1 egg",
    "..."
  ],
  "instructions": [
    "Step 1: ...",
    "Step 2: ...",
    "..."
  ],
  "tips": ["Optional cooking tip 1", "..."]
}

Consider dietary restrictions and cooking skill level. Prioritize recipes that use the majority of visible ingredients.
```

**Error Handling**

- API rate limiting
- Invalid image format handling
- Claude API timeout handling
- Fallback responses for unclear images

---

## Data Models & Types

```typescript
// src/types/index.ts

export interface Recipe {
  title: string;
  description: string;
  cookingTime: string;
  difficulty: 'Easy' | 'Medium' | 'Hard';
  servings: number;
  ingredients: string[];
  instructions: string[];
  tips?: string[];
}

export interface AnalyzeFridgeRequest {
  image: File;
  preferences?: string;
}

export interface AnalyzeFridgeResponse {
  success: boolean;
  recipe?: Recipe;
  error?: string;
}

export interface UploadProgress {
  loaded: number;
  total: number;
  percentage: number;
}

export interface ApiError {
  message: string;
  code: string;
  statusCode: number;
}
```

---

## User Interface Design

### Design Principles

- **Clean & Modern**: Minimalist design with focus on functionality
- **Mobile-First**: Responsive design optimized for mobile usage
- **Accessibility**: WCAG 2.1 AA compliance
- **Performance**: Optimized images and lazy loading

### Layout Structure

```
Header (App Name + Navigation)
├── Main Content Area
│   ├── Upload Section (FridgeUploader)
│   │   ├── Drag & Drop Zone
│   │   ├── File Picker Button
│   │   └── Upload Progress
│   └── Results Section (RecipeDisplay)
│       ├── Recipe Header
│       ├── Ingredients List
│       ├── Instructions
│       └── Actions (Save, Share, Print)
└── Footer
```

### Color Scheme & Styling

- Primary: Warm orange/red tones (hornito theme)
- Secondary: Neutral grays and whites
- Accent: Green for success states
- Error: Red for error states
- Use Tailwind CSS for consistent styling

---

## Security & Privacy

### Data Handling

- **No Persistent Storage**: Images are processed and immediately discarded
- **Secure Transmission**: HTTPS only for all communications
- **API Key Security**: Environment variables for sensitive credentials
- **Input Validation**: Strict file type and size validation

### Rate Limiting

- Implement rate limiting to prevent API abuse
- Max 10 requests per minute per IP
- Graceful degradation when limits are reached

### Privacy Considerations

- No user data collection
- No image storage beyond processing time
- Clear privacy policy regarding AI processing

---

## Performance Requirements

### Frontend Performance

- First Contentful Paint: < 2 seconds
- Largest Contentful Paint: < 3 seconds
- Cumulative Layout Shift: < 0.1
- Image optimization with Next.js Image component

### Backend Performance

- API response time: < 10 seconds for recipe generation
- File upload handling: Support up to 10MB images
- Concurrent request handling: 50+ simultaneous users

### Caching Strategy

- Static assets caching
- API response caching for common ingredients
- CDN integration for global performance

---

## Error Handling & Edge Cases

### Frontend Error States

1. **File Upload Errors**

   - Invalid file type
   - File too large
   - Network connectivity issues
   - Upload timeout

2. **API Response Errors**
   - No ingredients detected
   - Claude API unavailable
   - Invalid recipe format
   - Rate limit exceeded

### Backend Error Handling

1. **Image Processing Errors**

   - Corrupted image files
   - Unsupported formats
   - Processing timeouts

2. **Claude API Errors**
   - API key issues
   - Service unavailable
   - Response parsing errors
   - Rate limiting

### Fallback Strategies

- Generic recipe suggestions when analysis fails
- Offline recipe database for network issues
- Progressive enhancement for core functionality

---

## Development Workflow

### Environment Setup

```bash
# Required environment variables
ANTHROPIC_API_KEY=your_claude_api_key
NEXT_PUBLIC_APP_URL=http://localhost:3000
NODE_ENV=development
```

### Development Commands

```bash
npm run dev          # Start development server
npm run build        # Build for production
npm run start        # Start production server
npm run lint         # Run ESLint
npm run type-check   # TypeScript type checking
```

### Testing Strategy

- Unit tests for utility functions
- Integration tests for API endpoints
- Component testing with React Testing Library
- E2E testing with Playwright
- Visual regression testing

---

## Deployment & Infrastructure

### Production Environment

- **Platform**: Vercel (recommended) or similar serverless platform
- **Domain**: Custom domain with SSL
- **CDN**: Built-in CDN for static assets
- **Monitoring**: Error tracking and performance monitoring

### Environment Variables

```bash
ANTHROPIC_API_KEY=prod_api_key
NEXT_PUBLIC_APP_URL=https://elhornito.com
NODE_ENV=production
```

### Scaling Considerations

- Serverless functions for automatic scaling
- Image processing optimization
- Claude API usage monitoring
- Performance monitoring and alerting

---

## Future Enhancements

### Phase 2 Features

- User accounts and recipe history
- Dietary preference profiles
- Recipe rating and feedback
- Social sharing integration

### Phase 3 Features

- Multiple ingredient detection models
- Recipe difficulty customization
- Cooking timer integration
- Nutritional information display

### Technical Improvements

- Progressive Web App (PWA) capabilities
- Offline recipe access
- Advanced image preprocessing
- Multi-language support

---

## Success Metrics

### User Experience Metrics

- Time from upload to recipe: < 15 seconds
- Recipe accuracy rate: > 80%
- User satisfaction score: > 4.0/5.0
- Task completion rate: > 90%

### Technical Metrics

- API uptime: > 99.5%
- Error rate: < 2%
- Average response time: < 5 seconds
- Mobile performance score: > 90

---

## Dependencies & Libraries

### Production Dependencies

```json
{
  "@anthropic-ai/sdk": "^0.24.3",
  "next": "15.3.4",
  "react": "^19.0.0",
  "react-dom": "^19.0.0",
  "sharp": "^0.33.0",
  "zod": "^3.22.4"
}
```

### Development Dependencies

```json
{
  "typescript": "^5",
  "@types/node": "^20",
  "@types/react": "^19",
  "@types/react-dom": "^19",
  "tailwindcss": "^4",
  "eslint": "^9",
  "eslint-config-next": "15.3.4"
}
```

---

This specification provides a complete roadmap for implementing the Fridge Photo to Recipe application with Claude AI integration, ensuring a high-quality user experience and maintainable codebase.
